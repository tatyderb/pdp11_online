# Что будем делать в курсе

lesson = 669364

## Что будем писать

Разработка большой программы означает:

* программа пишется не за один подход, а её написание разбивается на этапы; на каждом этапе код отлаживается. Как разбить на этапы и что делать на каждом этапе мы подробно расскажем и опишем.
* кода много, его надо организовать в виде нескольких файлов.
* код лучше хранить в системе контроля версий, мы будем работать с git и рекомендуем хранить проект на github.com

Что будет делать наша программа? Она будет выполнять байткод программы, написанной на ассемблере для компьютера PDP-11. Это называется "эмулятор PDP-11".

В процессе мы познакомимся с архитектурой компьютера, ассемблером (их много, мы будем уметь читать программы на ассемблере PDP-11, самого простого ассемблера в мире, прародителя языка Си, и очень близкого родственника некоторых современных ассемблеров).

### Что НЕ нужно знать и чему научим

Понятию байт, архитектура компьютера, ассемблер, git.

### Что нужно знать и уметь?

Нужно программировать на одном из языков, где есть поддержка побитовых команд (мы будем работать с битами). Они точно есть в языках C, C++, Python, Pascal, Java и многих других языках. Примеры кода будут даны на языке С.

* [Системы счисления: десятичная, двоичная, восьмеричная, шестнадцатеричная](https://stepik.org/lesson/666766/step/1)
* [Представление целых чисел в компьютере](https://stepik.org/lesson/306538/step/1)
* [Переполнение и знаковое переполнение](https://stepik.org/lesson/665907/step/5)

Все ещё не понимаете, что будем писать? Тогда решим задачу.

## SKIP TASKINLINE cpu Примитивная программа на примитивном компьютере

Пусть где-то существует компьютер. У него только 4 ячейки памяти. Ячейка памяти называется в этом компьютере "регистр". Каждая ячейка размером в 8 бит. Эти ячейки имеют название и **адрес** по которому обращаются к этому регистру.

| Название регистра | Адрес регистра |
|----|----|
| A | 5 |
| B | 6 |
| C | 7 |
| D | 8 |

Для работы на этом компьютере есть язык программирования. Для компьютера команды кодируются числами, для человека для команд есть мнемоники.

| Код | Мнемоника | Аргументы | Что делает |
|----|----|----|----------|
| 0 | HLT | нет | Конец программы, стоп (halt) |
| 1 | ADD | reg1 reg2 | Сложить числа из регистров reg1 и reg2, результат записать в reg1 |
| 2 | SUB | reg1 reg2 | Вычесть числа из регистров reg1 и reg2, результат записать в reg1 |
| 3 | MOV | reg число | Записать число в регистр reg |
| 4 | IR | нет | напечатать числа из всех регистров через пробел |

Дана программа в виде чисел (кодов) для компьютера. Выполнить программу для этого компьютера (будем называть ее байт-код).

То есть мы пишем свою программу. В ней создаем переменные, которые будут исполнять роль регистров нашего примитивного компьютера. Читаем байт-код, разбираем что в нем закодировано и изменяем значения наших "регистров" и печатаем их значения.

**До начала работы программы в регистрах нули. Все числа считаются беззнаковыми.**

### Пример 1

Например, есть код, разберем его. Код:
```cpp
3 5 1
3 6 2
1 5 6
4
0
```
Должен напечатать
```cpp
3 2 0 0
```
Разберем почему должен быть такой результат:

| Код | Мнемоника |Что делает | Содержимое регистров A B C D |
|----|----|----------|----|
| 3 5 1 | MOV A 1 | Записать в регистр А число 1 | 1 0 0 0 |
| 3 6 2 | MOV B 2 | Записать в регистр B число 2 | 1 2 0 0 |
| 1 5 6 | ADD A B | Сложить регистры A и B, результат записать в A | 3 2 0 0 |
| 4 | IR | Напечатать регистры. Печатает `3 2 0 0` | 3 2 0 0 |
| 0 | HLT | Конец программы, стоп (halt) | 3 2 0 0 |

### Пример 2

Например, есть код, разберем его. Код:
```cpp
3 6 7
3 7 1
2 6 7
4
0
```
Должен напечатать
```cpp
0 6 1 0
```
Разберем почему должен быть такой результат:

| Код | Мнемоника |Что делает | Содержимое регистров A B C D |
|----|----|----------|----|
| 3 6 7 | MOV B 7 | Записать в регистр B число 7 | 0 7 0 0 |
| 3 7 1 | MOV C 1 | Записать в регистр C число 1 | 0 7 1 0 |
| 2 6 7 | SUB B C | Вычесть из регистра B регистр С, результат записать в B | 0 6 1 0 |
| 4 | IR | Напечатать регистры. Печатает `0 6 1 0` | 0 6 1 0 |
| 0 | HLT | Конец программы, стоп (halt) | 0 6 1 0 |

*Кто считает, что в тесте номер 6 ошибка, пишет как представить число 256 в виде 8 бинарных цифр.*

TEST
3 5 1
3 6 2
1 5 6
4
0
----
3 2 0 0
====
3 6 7
3 7 1
2 6 7
4
0
----
0 6 1 0
====
4
0
----
0 0 0 0
====
3 5 1 
4 
3 6 2 
4 
3 7 3 
4 
3 8 4 
4 
0
----
1 0 0 0 
1 2 0 0 
1 2 3 0 
1 2 3 4 
====
3 6 10 
1 5 6 
1 5 6 
1 5 6 
4 
0
----
30 10 0 0 
====
3 6 128 
1 5 6 
1 5 6 
4 
1 5 6 
4 
0
----
0 128 0 0 
128 128 0 0 
====

## Научились

Мы написали эмулятор этого "примитивного компьютера", научились разбирать его байт-код (закодированную программу) и исполнять его.

У PDP-11 побольше процессоров, есть дополнительные ячейки памяти, другие правила кодирования команд и набор команд побольше.

Но основные принципы остаются теми же. Как видите, все просто.

Пора начать работу над эмулятором PDP-11, описать его "память" и реализовать функции для работы с ней. Сначала нужно узнать термины из архитектуры компьютеров.



